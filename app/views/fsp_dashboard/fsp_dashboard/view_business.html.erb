<div class="container py-4">
  <h1><%= t('fsp.view.title', name: @user.name) %></h1>

  <div class="row">
    <!-- Total Revenue -->
    <div class="col-md-4">
      <div class="card text-white bg-primary mb-3">
        <div class="card-header"><%= t('dashboard.cards.total_revenue') %></div>
        <div class="card-body">
          <h5 class="card-title"><%= number_to_currency(@total_revenue, unit: "RWF ", precision: 0) %></h5>
        </div>
      </div>
    </div>

    <!-- Total Expenses -->
    <div class="col-md-4">
      <div class="card text-white bg-warning mb-3">
        <div class="card-header"><%= t('dashboard.cards.total_expenses') %></div>
        <div class="card-body">
          <h5 class="card-title"><%= number_to_currency(@total_expenses, unit: "RWF ", precision: 0) %></h5>
        </div>
      </div>
    </div>

    <!-- Total Income -->
    <div class="col-md-4">
      <div class="card text-white bg-info mb-3">
        <div class="card-header"><%= t('dashboard.cards.total_income') %></div>
        <div class="card-body">
          <h5 class="card-title"><%= number_to_currency(@total_income, unit: "RWF ", precision: 0) %></h5>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Net Profit -->
    <div class="col-md-4">
      <div class="card text-white bg-success mb-3">
        <div class="card-header"><%= t('dashboard.cards.net_profit') %></div>
        <div class="card-body">
          <h5 class="card-title"><%= number_to_currency(@net_profit, unit: "RWF ", precision: 0) %></h5>
        </div>
      </div>
    </div>

    <!-- Low Stock -->
    <div class="col-md-4">
      <div class="card text-white bg-danger mb-3">
        <div class="card-header"><%= t('dashboard.cards.low_stock') %></div>
        <div class="card-body">
          <% if @low_stock_products.any? %>
            <% @low_stock_products.each do |product| %>
              <p><%= product.name %> — <%= t('dashboard.labels.stock_left') %>: <%= product.quantity %></p>
            <% end %>
          <% else %>
            <p><%= t('dashboard.messages.all_stock_ok') %></p>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Top Selling -->
    <div class="col-md-4">
      <div class="card text-white bg-secondary mb-3">
        <div class="card-header"><%= t('dashboard.cards.top_selling') %></div>
        <div class="card-body">
          <% if @top_selling_products.any? %>
            <% @top_selling_products.each do |product| %>
              <p><%= product.name %> — <%= t('dashboard.labels.sold') %>: <%= product.total_sold %></p>
            <% end %>
          <% else %>
            <p><%= t('dashboard.messages.no_top_selling') %></p>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Products -->
  <div class="row">
    <div class="col-md-12 mt-4">
      <h2><%= t('dashboard.tables.products.title') %></h2>
      <table class="table table-striped">
        <thead>
          <tr>
            <th><%= t("dashboard.tables.products.columns.name") %></th>
            <th><%= t("dashboard.tables.products.columns.category") %></th>
            <th><%= t("dashboard.tables.products.columns.price") %></th>
            <th><%= t("dashboard.tables.products.columns.quantity") %></th>

          </tr>
        </thead>
        <tbody>
          <% @products.each do |product| %>
            <tr>
              <td><%= product.name %></td>
              <td><%= product.category %></td>
              <td>RWF <%= product.price %></td>
              <td><%= product.quantity %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <!-- Sales -->
    <div class="col-md-12 mt-4">
      <h2><%= t('dashboard.tables.sales.title') %></h2>
      <table class="table table-striped">
        <thead>
          <tr>
            <th><%= t("dashboard.tables.sales.columns.product") %></th>
            <th><%= t("dashboard.tables.sales.columns.quantity") %></th>
            <th><%= t("dashboard.tables.sales.columns.total_price") %></th>
            <th><%= t("dashboard.tables.sales.columns.date") %></th>

          </tr>
        </thead>
        <tbody>
          <% @sales.each do |sale| %>
            <tr>
              <td><%= sale.product.name %></td>
              <td><%= sale.quantity %></td>
              <td>RWF <%= sale.total_price %></td>
              <td><%= l(sale.date, format: :ymd) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <!-- Income -->
    <div class="col-md-12 mt-4">
      <h2><%= t('dashboard.tables.incomes.title') %></h2>
      <table class="table table-striped">
        <thead>
          <tr>
            <th><%= t("dashboard.tables.incomes.columns.name") %></th>
            <th><%= t("dashboard.tables.incomes.columns.category") %></th>
            <th><%= t("dashboard.tables.incomes.columns.amount") %></th>
            <th><%= t("dashboard.tables.incomes.columns.date") %></th>
          </tr>
        </thead>
        <tbody>
          <% @incomes.each do |income| %>
            <tr>
              <td><%= income.name %></td>
              <td><%= income.category %></td>
              <td>RWF <%= income.amount %></td>
              <td><%= l(income.date, format: :ymd) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <!-- Expenses -->
    <div class="col-md-12 mt-4">
      <h2><%= t('dashboard.tables.expenses.title') %></h2>
      <table class="table table-striped">
        <thead>
          <tr>
            <th><%= t("dashboard.tables.expenses.columns.name") %></th>
            <th><%= t("dashboard.tables.expenses.columns.category") %></th>
            <th><%= t("dashboard.tables.expenses.columns.amount") %></th>
            <th><%= t("dashboard.tables.expenses.columns.date") %></th>
          </tr>
        </thead>
        <tbody>
          <% @expenses.each do |expense| %>
            <tr>
              <td><%= expense.name %></td>
              <td><%= expense.category %></td>
              <td>RWF <%= expense.amount %></td>
              <td><%= l(expense.date, format: :ymd) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
